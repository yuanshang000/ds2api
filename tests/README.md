# DS2API æµ‹è¯•æ–‡æ¡£

## æµ‹è¯•æ–‡ä»¶ç»“æ„

```
tests/
â”œâ”€â”€ __init__.py           # æµ‹è¯•æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ test_unit.py          # å•å…ƒæµ‹è¯•ï¼ˆä¸ä¾èµ–ç½‘ç»œï¼‰
â”œâ”€â”€ test_all.py           # API é›†æˆæµ‹è¯•
â”œâ”€â”€ test_accounts.py      # è´¦å·æ± æµ‹è¯•
â””â”€â”€ run_tests.sh          # æµ‹è¯•è¿è¡Œè„šæœ¬
```

## å¿«é€Ÿå¼€å§‹

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# ä½¿ç”¨è„šæœ¬
./tests/run_tests.sh all

# æˆ–ç›´æ¥è¿è¡Œ
python3 tests/test_unit.py      # å•å…ƒæµ‹è¯•
python3 tests/test_all.py       # API æµ‹è¯•
```

### è¿è¡Œå•å…ƒæµ‹è¯•

```bash
python3 tests/test_unit.py
```

æµ‹è¯•å†…å®¹ï¼š
- é…ç½®åŠ è½½
- æ¶ˆæ¯å¤„ç†ï¼ˆ`messages_prepare`ï¼‰
- WASM ç¼“å­˜
- æ¨¡å‹é…ç½®è·å–
- æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼
- æµå¼å“åº”è§£æ
- **å·¥å…·è°ƒç”¨è§£æ**ï¼ˆ`parse_tool_calls`ï¼‰
- **Token ä¼°ç®—**

### è¿è¡Œ API é›†æˆæµ‹è¯•

```bash
# å®Œæ•´æµ‹è¯•
python3 tests/test_all.py

# å¿«é€Ÿæµ‹è¯•ï¼ˆè·³è¿‡è€—æ—¶æµ‹è¯•ï¼‰
python3 tests/test_all.py --quick

# æŒ‡å®šç«¯ç‚¹
python3 tests/test_all.py --endpoint http://your-server.com

# è¯¦ç»†è¾“å‡º
python3 tests/test_all.py --verbose
```

æµ‹è¯•è¦†ç›–ï¼š

| ç±»åˆ« | æµ‹è¯•é¡¹ |
|-----|--------|
| åŸºç¡€ | æœåŠ¡å¥åº·æ£€æŸ¥ |
| OpenAI | æ¨¡å‹åˆ—è¡¨ã€éæµå¼å¯¹è¯ã€æµå¼å¯¹è¯ã€æ— æ•ˆæ¨¡å‹å¤„ç†ã€è®¤è¯é”™è¯¯ã€Reasoner æ¨¡å¼ |
| Claude | æ¨¡å‹åˆ—è¡¨ã€éæµå¼æ¶ˆæ¯ã€æµå¼æ¶ˆæ¯ã€Token è®¡æ•° |
| é«˜çº§ | å¤šè½®å¯¹è¯ã€é•¿è¾“å…¥å¤„ç† |
| **å·¥å…·è°ƒç”¨** | OpenAI å·¥å…·è°ƒç”¨ï¼ˆæµå¼/éæµå¼ï¼‰ã€Claude å·¥å…·è°ƒç”¨ |
| **æœç´¢æ¨¡å¼** | OpenAI æœç´¢æ¨¡å¼ |

### è¿è¡Œè´¦å·æµ‹è¯•

```bash
# æµ‹è¯•æ‰€æœ‰è´¦å·ç™»å½•
python3 tests/test_accounts.py --login

# æµ‹è¯•è´¦å·è½®æ¢
python3 tests/test_accounts.py --rotation

# è¿è¡Œæ‰€æœ‰
python3 tests/test_accounts.py --all
```

## é…ç½®

æµ‹è¯•ä½¿ç”¨ `config.json` ä¸­çš„é…ç½®ï¼š

```json
{
  "keys": ["test-api-key-001"],
  "accounts": [
    {"email": "xxx@gmail.com", "password": "xxx", "token": ""}
  ]
}
```

## é¢„æœŸè¾“å‡º

### å•å…ƒæµ‹è¯•

```
Ran 32 tests in 9.0s
OK
```

### API æµ‹è¯•

```
ğŸ“Š æµ‹è¯•æŠ¥å‘Š
æ€»è®¡: 18 ä¸ªæµ‹è¯•
âœ… é€šè¿‡: 18
âŒ å¤±è´¥: 0
â±ï¸  è€—æ—¶: ~60s
ğŸ“ˆ é€šè¿‡ç‡: 100.0%
```

## æ•…éšœæ’é™¤

### æœåŠ¡æœªè¿è¡Œ

```
âš ï¸  æœåŠ¡æœªè¿è¡Œï¼Œè·³è¿‡å…¶ä»–æµ‹è¯•
```

è§£å†³ï¼šå…ˆå¯åŠ¨æœåŠ¡ `python dev.py`

### è®¤è¯å¤±è´¥

```
âŒ å¤±è´¥: çŠ¶æ€ç : 401
```

è§£å†³ï¼šæ£€æŸ¥ `config.json` ä¸­çš„ API key å’Œè´¦å·é…ç½®

### æµå¼æµ‹è¯•è¶…æ—¶

å¯èƒ½æ˜¯ DeepSeek API å“åº”æ…¢ï¼Œå¯ä»¥å°è¯•ï¼š
- ä½¿ç”¨ `--quick` æ¨¡å¼
- å¢åŠ æµ‹è¯•è¶…æ—¶æ—¶é—´
